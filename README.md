# Homelab K3s –ö–ª–∞—Å—Ç–µ—Ä

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ K3s Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞ –¥–ª—è –¥–æ–º–∞—à–Ω–µ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
homelab/
‚îú‚îÄ‚îÄ k3s/
‚îÇ   ‚îú‚îÄ‚îÄ k3s.md                    # –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ K3s –∫–ª–∞—Å—Ç–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ k3s.config.yaml           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è kubectl
‚îú‚îÄ‚îÄ traefik/
‚îÇ   ‚îú‚îÄ‚îÄ traefik.md                # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Traefik ingress –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ traefik-values.yaml       # Helm values –¥–ª—è Traefik
‚îÇ   ‚îú‚îÄ‚îÄ nginx-manifest.yaml       # –ü—Ä–∏–º–µ—Ä nginx –¥–µ–ø–ª–æ—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ nginx-clusterip-manifest.yaml # ClusterIP —Å–µ—Ä–≤–∏—Å –¥–ª—è nginx
‚îÇ   ‚îî‚îÄ‚îÄ nginx-ingressroute.yaml   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Traefik IngressRoute
‚îú‚îÄ‚îÄ longhorn/
‚îÇ   ‚îú‚îÄ‚îÄ longhorn.md               # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Longhorn
‚îÇ   ‚îú‚îÄ‚îÄ longhorn-values.yaml      # Helm values –¥–ª—è Longhorn
‚îÇ   ‚îú‚îÄ‚îÄ longhorn-ingressroute.yaml # IngressRoute –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ longhorn-smb-secret.yaml  # –°–µ–∫—Ä–µ—Ç –¥–ª—è SMB –±—ç–∫–∞–ø–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ portainer-values.yaml     # –¢–µ—Å—Ç–æ–≤—ã–π –¥–µ–ø–ª–æ–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ PV
‚îî‚îÄ‚îÄ grafana-prometheus/
    ‚îú‚îÄ‚îÄ grafana.md                # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Grafana + Prometheus
    ‚îú‚îÄ‚îÄ grafana-values.yaml       # Helm values –¥–ª—è kube-prometheus-stack
    ‚îú‚îÄ‚îÄ grafana-secret.yaml       # –°–µ–∫—Ä–µ—Ç —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ Grafana
    ‚îî‚îÄ‚îÄ grafana-ingressroute.yaml # IngressRoute –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Grafana
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ K3s –∫–ª–∞—Å—Ç–µ—Ä–∞**: –°–ª–µ–¥—É–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É –≤ [k3s/k3s.md](k3s/k3s.md):
   - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω —Å Ubuntu Server 24.04 LTS
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–µ–π –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö IP –∞–¥—Ä–µ—Å–æ–≤
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ K3s —Å –ø–æ–º–æ—â—å—é k3sup
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ kube-vip –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –¥–ª—è –≤—ã—Å–æ–∫–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

2. **–î–µ–ø–ª–æ–π Traefik**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [traefik/traefik.md](traefik/traefik.md):
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Traefik –∫–∞–∫ ingress –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS –∏ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Traefik –¥–∞—à–±–æ—Ä–¥–∞

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞**: –°–ª–µ–¥—É–π—Ç–µ [longhorn/longhorn.md](longhorn/longhorn.md):
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Longhorn –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö —Ç–æ–º–æ–≤
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ NAS
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Portainer

4. **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [grafana-prometheus/grafana.md](grafana-prometheus/grafana.md):
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Grafana –∏ Prometheus
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞—à–±–æ—Ä–¥–æ–≤ –∏ –∞–ª–µ—Ä—Ç–æ–≤
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∞

## üõ† –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **K3s**: –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π Kubernetes –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤
- **kube-vip**: –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –≤—ã—Å–æ–∫–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞
- **Traefik**: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π HTTP reverse proxy –∏ ingress –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
- **Helm**: –ü–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è Kubernetes

### –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **Longhorn**: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–ª–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **SMB/CIFS**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å NAS –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ
- **Prometheus**: –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫
- **Grafana**: –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Alertmanager**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–∞–º–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
- **Node Exporter**: –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ —Ö–æ—Å—Ç–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
- **kube-state-metrics**: –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ Kubernetes

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- 3 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã —Å Ubuntu Server 24.04 LTS
- –ú–∏–Ω–∏–º—É–º 4GB RAM –∏ 50GB –¥–∏—Å–∫–∞ –Ω–∞ –∫–∞–∂–¥—É—é VM
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ IP –∞–¥—Ä–µ—Å–∞
- NAS –∏–ª–∏ —Å–µ—Ç–µ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º DNS –∑–∞–ø–∏—Å–µ–π
- –õ–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏:
  - kubectl
  - k3sup
  - helm

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–∏

–ö–ª–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Å—Ö–µ–º—É IP –∞–¥—Ä–µ—Å–∞—Ü–∏–∏:
- **–ú–∞—Å—Ç–µ—Ä –Ω–æ–¥—ã**: 192.168.10.11-13
- **VIP –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞**: 192.168.10.10
- **–ü—É–ª –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤**: 192.168.30.11-99

### –î–æ–º–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞
- `traefik.kube.ancored.ru` - Traefik –¥–∞—à–±–æ—Ä–¥
- `longhorn.kube.ancored.ru` - Longhorn –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- `grafana.kube.ancored.ru` - Grafana –¥–∞—à–±–æ—Ä–¥—ã

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö:

### –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [k3s/k3s.md](k3s/k3s.md) - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ K3s –∫–ª–∞—Å—Ç–µ—Ä–∞
- [traefik/traefik.md](traefik/traefik.md) - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Traefik ingress –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

### –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [longhorn/longhorn.md](longhorn/longhorn.md) - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è
- [grafana-prometheus/grafana.md](grafana-prometheus/grafana.md) - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–µ–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
